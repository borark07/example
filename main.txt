–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º –∏–∑–æ–ª—è—Ü–∏–∏ –≤ —è–¥—Ä–µ Linux –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–∑–æ–ª—è—Ü–∏–∏: "–ú–Ω–æ–≥–æ—ç—Ç–∞–∂–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —è–¥—Ä–æ Linux ‚Äî —ç—Ç–æ —É–º–Ω—ã–π –¥–æ–º, –≥–¥–µ –∫–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∂–∏–≤—ë—Ç –≤ —Å–≤–æ–µ–π –∫–≤–∞—Ä—Ç–∏—Ä–µ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ), –∏ —É –∫–∞–∂–¥–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã –µ—Å—Ç—å:

üè† 1. Namespaces (–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω) - —Å—Ç–µ–Ω—ã –º–µ–∂–¥—É –∫–≤–∞—Ä—Ç–∏—Ä–∞–º–∏

PID Namespace - —Å–≤–æ—è –Ω—É–º–µ—Ä–∞—Ü–∏—è –∂–∏–ª—å—Ü–æ–≤

```bash
# –í –∫–∞–∂–¥–æ–π –∫–≤–∞—Ä—Ç–∏—Ä–µ —Å–≤–æ–∏ –∂–∏–ª—å—Ü—ã —Å –Ω–æ–º–µ—Ä–∞–º–∏ 1,2,3...
# –ö–≤–∞—Ä—Ç–∏—Ä–∞ ‚Ññ1: –∂–∏–ª–µ—Ü ‚Ññ1 (nginx), –∂–∏–ª–µ—Ü ‚Ññ2 (php-fpm)
# –ö–≤–∞—Ä—Ç–∏—Ä–∞ ‚Ññ2: –∂–∏–ª–µ—Ü ‚Ññ1 (mysql), –∂–∏–ª–µ—Ü ‚Ññ2 (redis)
# –û–Ω–∏ –Ω–µ –∑–Ω–∞—é—Ç –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏ —Å–æ—Å–µ–¥–µ–π!
```

NET Namespace - —Å–≤–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ —Ç–µ–ª–µ—Ñ–æ–Ω

```bash
# –í –∫–∞–∂–¥–æ–π –∫–≤–∞—Ä—Ç–∏—Ä–µ:
# - –°–≤–æ–π WiFi —Ä–æ—É—Ç–µ—Ä (—Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
# - –°–≤–æ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (IP –∞–¥—Ä–µ—Å)
# - –°–≤–æ—è —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∞—è –∫–Ω–∏–≥–∞ (ARP —Ç–∞–±–ª–∏—Ü–∞)
```

MNT Namespace - —Å–≤–æ—è –º–µ–±–µ–ª—å –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞

```bash
# –í –∫–∞–∂–¥–æ–π –∫–≤–∞—Ä—Ç–∏—Ä–µ:
# - –°–≤–æ—è –º–µ–±–µ–ª—å (—Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏)
# - –°–≤–æ—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π) 
# - –°–≤–æ–∏ –æ–∫–Ω–∞ (—Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```

UTS Namespace - —Å–≤–æ–π –∞–¥—Ä–µ—Å –¥–æ–º–∞

```bash
# –ö–∞–∂–¥–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –º–æ–∂–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å –¥–æ–º –ø–æ-—Å–≤–æ–µ–º—É:
hostname my-app-container  # –¢–æ–ª—å–∫–æ –≤ —ç—Ç–æ–π "–∫–≤–∞—Ä—Ç–∏—Ä–µ"
```

IPC Namespace - —Å–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

```bash
# –°–≤–æ—è –ø–æ—á—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏:
# - –û—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
# - –†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å
# - –°–µ–º–∞—Ñ–æ—Ä—ã
```

USER Namespace - —Å–≤–æ–∏ –ø–∞—Å–ø–æ—Ä—Ç–∞ –∂–∏–ª—å—Ü–æ–≤

```bash
# –í –∫–≤–∞—Ä—Ç–∏—Ä–µ –º–æ–∂–Ω–æ –±—ã—Ç—å "root", –Ω–æ –≤ –¥–æ–º–µ - –æ–±—ã—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
# –ñ–∏–ª–µ—Ü –¥—É–º–∞–µ—Ç —á—Ç–æ –æ–Ω —Ö–æ–∑—è–∏–Ω, –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —É –Ω–µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞
```

CGROUP Namespace - —Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ–º–∞

```bash
# –ö–∞–∂–¥–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
# "–ú–Ω–µ –º–æ–∂–Ω–æ 1GB –ø–∞–º—è—Ç–∏" - –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ —Å–æ—Å–µ–¥—É —Ä–∞–∑—Ä–µ—à–µ–Ω–æ 2GB
```

TIME Namespace - —Å–≤–æ–∏ —á–∞—Å—ã

```bash
# –ö–∞–∂–¥–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –º–æ–∂–µ—Ç –∂–∏—Ç—å –≤ —Å–≤–æ–µ–º –≤—Ä–µ–º–µ–Ω–∏:
# - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥—É–º–∞–µ—Ç, —á—Ç–æ —Å–µ–π—á–∞—Å 2020 –≥–æ–¥
# - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤–∏–¥–∏—Ç –≤—Ä–µ–º—è –≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ
```

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ namespace:

```bash
# –°–Ω–∏–º–∞–µ–º "–∫–≤–∞—Ä—Ç–∏—Ä—É" —Å–æ –≤—Å–µ–º–∏ —É–¥–æ–±—Å—Ç–≤–∞–º–∏
unshare --pid --net --mount --uts --ipc --user --time --fork bash

# –¢–µ–ø–µ—Ä—å –º—ã –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∏—Ä–µ:
echo $$                    # –ü–æ–∫–∞–∂–µ—Ç 1 - –º—ã –≥–ª–∞–≤–Ω—ã–µ –∑–¥–µ—Å—å!
hostname my-container      # –ú–µ–Ω—è–µ–º –∏–º—è —Ç–æ–ª—å–∫–æ —É —Å–µ–±—è
```

‚öñÔ∏è 2. Cgroups (Control Groups) - –ø—Ä–∞–≤–∏–ª–∞ –æ–±—â–µ–∂–∏—Ç–∏—è

–≠—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ª–∏–º–∏—Ç—ã:

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:

```bash
# –ö–≤–∞—Ä—Ç–∏—Ä–∞ "web-app" –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
echo "500M" > /sys/fs/cgroup/web-app/memory.max    # 500MB –ø–∞–º—è—Ç–∏
echo "50000" > /sys/fs/cgroup/web-app/cpu.max      # 50% –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
echo "100M" > /sys/fs/cgroup/web-app/io.max        # 100MB/—Å –¥–∏—Å–∫–∞

# –ö–≤–∞—Ä—Ç–∏—Ä–∞ "database" –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
echo "1G" > /sys/fs/cgroup/database/memory.max     # 1GB –ø–∞–º—è—Ç–∏  
echo "25000" > /sys/fs/cgroup/database/cpu.max     # 25% –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
```

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã cgroups v2:

¬∑ memory - –ª–∏–º–∏—Ç—ã –ø–∞–º—è—Ç–∏
¬∑ cpu - –ª–∏–º–∏—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
¬∑ io - –ª–∏–º–∏—Ç—ã –¥–∏—Å–∫–æ–≤–æ–≥–æ I/O
¬∑ pids - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
¬∑ cpuset - –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —è–¥—Ä–∞–º CPU

üîê 3. Capabilities (–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏) - —É—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç—É–ø–∞

–ö–∞–∫ —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –æ—Ç –∫–æ–º–Ω–∞—Ç –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ:

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

```bash
# CAP_NET_BIND_SERVICE - –∫–ª—é—á –æ—Ç –ø–æ—Ä—Ç–∞ 80 (–æ–±—ã—á–Ω–æ —Ç–æ–ª—å–∫–æ —É root)
# CAP_SYS_ADMIN - –∫–ª—é—á –æ—Ç –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç (–∞–¥–º–∏–Ω—Å–∫–∏–µ –ø—Ä–∞–≤–∞)
# CAP_DAC_OVERRIDE - –æ—Ç–º—ã—á–∫–∞ (–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤ —Ñ–∞–π–ª–æ–≤)
# CAP_SYS_CHROOT - –∫–ª—é—á –æ—Ç –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∏ (—Å–º–µ–Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–π –§–°)
```

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```bash
# –î–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º–µ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–ª—é—á–∏:
capsh --drop=all --add=cap_net_bind_service -- -c "./web-server"
# –¢–µ–ø–µ—Ä—å –æ–Ω–∞ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç 80, –Ω–æ –Ω–µ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ
```

üõ°Ô∏è 4. Security Mechanisms - —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Seccomp (–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è) - —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

```json
{
      "—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ_–¥–µ–π—Å—Ç–≤–∏—è": [
            "—á–∏—Ç–∞—Ç—å_—Ñ–∞–π–ª—ã",
                "–æ—Ç–∫—Ä—ã—Ç—å_—Å–µ—Ç–µ–≤–æ–µ_—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ",
                    "–≤—ã–¥–µ–ª–∏—Ç—å_–ø–∞–º—è—Ç—å"
      ],
        "–∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ_–¥–µ–π—Å—Ç–≤–∏—è": [
                "–∏–∑–º–µ–Ω—è—Ç—å_—Å–∏—Å—Ç–µ–º–Ω–æ–µ_–≤—Ä–µ–º—è", 
                    "—Å–æ–∑–¥–∞–≤–∞—Ç—å_—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞",
                        "—É–ø—Ä–∞–≤–ª—è—Ç—å_—è–¥—Ä–æ–º"
        ]
}
```

AppArmor/SELinux - –æ—Ö—Ä–∞–Ω–Ω–∏–∫–∏

¬∑ AppArmor - "–ù–µ –¥–µ–ª–∞–π —Ç–æ, —á—Ç–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ!"
¬∑ SELinux - "–î–µ–ª–∞–π –¢–û–õ–¨–ö–û —Ç–æ, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏!"

–ü—Ä–æ—Ñ–∏–ª—å AppArmor –¥–ª—è nginx:

```bash
# nginx –º–æ–∂–µ—Ç:
# - –ß–∏—Ç–∞—Ç—å /var/www/html/
# - –ü–∏—Å–∞—Ç—å –≤ /var/log/nginx/
# - –°–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç 80

# nginx –ù–ï –º–æ–∂–µ—Ç:
# - –ß–∏—Ç–∞—Ç—å /etc/shadow
# - –ó–∞–ø—É—Å–∫–∞—Ç—å bash
# - –ú–µ–Ω—è—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

üîÑ 5. Checkpoint/Restore (CRIU) - –∑–∞–º–æ—Ä–æ–∑–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: –ú–æ–∂–Ω–æ "–∑–∞–º–æ—Ä–æ–∑–∏—Ç—å" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –ø–æ—Ç–æ–º "—Ä–∞–∑–º–æ—Ä–æ–∑–∏—Ç—å"!

```bash
# –ö–∞–∫ –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–≥—Ä–µ:
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ‚Üí –í—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä ‚Üí –í–∫–ª—é—á–∏—Ç—å ‚Üí –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

# "–ó–∞–º–æ—Ä–æ–∑–∏—Ç—å" —Ä–∞–±–æ—Ç–∞—é—â–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
criu dump -t <PID> --images-dir /checkpoint/

# "–†–∞–∑–º–æ—Ä–æ–∑–∏—Ç—å" –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–µ—Ä–µ:
criu restore --images-dir /checkpoint/
```

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

¬∑ –ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è
¬∑ –ë—ç–∫–∞–ø—ã —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
¬∑ –û—Ç–ª–∞–¥–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

üéØ 6. eBPF - —Å—É–ø–µ—Ä—Å–∏–ª–∞ –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è

–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: –ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø—Ä—è–º–æ –≤ —è–¥—Ä–æ!

–ß—Ç–æ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å eBPF:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å "–∫–∞–º–µ—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏—è" –≤ —è–¥—Ä–µ:
# - –°–ª–µ–¥–∏—Ç—å –∑–∞ —Å–µ—Ç–µ–≤—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
# - –°—á–∏—Ç–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã
# - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
# - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
```

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–∞ eBPF:

¬∑ Falco - —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
¬∑ Cilium - —Å–µ—Ç–µ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ
¬∑ BCC/BPFTrace - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ü—Ä–∏–º–µ—Ä eBPF –ø—Ä–æ–≥—Ä–∞–º–º—ã:

```bash
# –°–ª–µ–¥–∏—Ç—å –∑–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
bpftrace -e 'tracepoint:syscalls:sys_enter_openat { 
        printf("–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä %s –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª: %s\n", comm, str(args->filename)); 
}'
```

üîç 7. Audit Subsystem - —Å–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞

–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: –î–µ—Ç–µ–∫—Ç–∏–≤, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è!

```bash
# –í–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
# "15:30 - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä web-app –ø–æ–ø—ã—Ç–∞–ª—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å /etc/shadow"
# "15:31 - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä database —Å–¥–µ–ª–∞–ª –Ω–µ–æ–±—ã—á–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤"
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏—Ç–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
# –°–ª–µ–¥–∏—Ç—å –∑–∞ –¥–æ—Å—Ç—É–ø–æ–º –∫ –≤–∞–∂–Ω—ã–º —Ñ–∞–π–ª–∞–º
auditctl -w /etc/passwd -p war -k container_access

# –°–ª–µ–¥–∏—Ç—å –∑–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
auditctl -a always,exit -S open -S openat -k container_file_access
```

üåê 8. Network Stack - —Å–µ—Ç–µ–≤–∞—è –∏–∑–æ–ª—è—Ü–∏—è

Netfilter/iptables - —Å–µ—Ç–µ–≤–∞—è —Ç–∞–º–æ–∂–Ω—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ "–ø–∞—Å–ø–æ—Ä—Ç–æ–≤" —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤:
# - iptables - –ø—Ä–∞–≤–∏–ª–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
# - nftables - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–º–µ–Ω–∞ iptables
```

TC (Traffic Control) - —Å–≤–µ—Ç–æ—Ñ–æ—Ä –¥–ª—è —Å–µ—Ç–∏

```bash
# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
# - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (traffic shaping)
# - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ (QoS)
# - –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
```

XDP (eXpress Data Path) - —Å–∫–æ—Ä–æ—Å—Ç–Ω–∞—è –º–∞–≥–∏—Å—Ç—Ä–∞–ª—å

```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –î–û —è–¥—Ä–∞ Linux
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç eBPF –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
# –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```

üíæ 9. Storage Features - –∏–∑–æ–ª—è—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

OverlayFS - –Ω–∞—Å–ª–æ–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

```bash
# –ö–∞–∫ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –∫–∞–ª—å–∫–∏:
# base layer (–æ–±—Ä–∞–∑) + container layer (–∏–∑–º–µ–Ω–µ–Ω–∏—è) = –∏—Ç–æ–≥–æ–≤–∞—è –§–°
```

Filesystem Notifications - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```bash
# –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç "–ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è" –Ω–∞ —Å–æ–±—ã—Ç–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:
inotifywait -m /data -e create,delete,modify
# "–°–æ–æ–±—â–∏ –º–Ω–µ, –∫–æ–≥–¥–∞ —Ñ–∞–π–ª—ã –≤ /data –∏–∑–º–µ–Ω—è—Ç—Å—è"
```

üõ†Ô∏è 10. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏

perf - –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫ —è–¥—Ä–∞

```bash
# –°–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞:
perf record -p <CONTAINER_PID>    # –ó–∞–ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
perf report                       # –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç—á–µ—Ç
```

strace - —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–∑–æ–≤–æ–≤

```bash
# –°–ª–µ–¥–∏—Ç—å –∑–∞ –≤—Å–µ–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
strace -p <CONTAINER_PID> -f -e trace=network,file
```

/proc filesystem - –æ–∫–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å "–≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
cat /proc/<PID>/cgroup     # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
cat /proc/<PID>/status     # –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞  
ls /proc/<PID>/ns/         # Namespaces –ø—Ä–æ—Ü–µ—Å—Å–∞
```

üé™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

–®–∞–≥ 1: –°–Ω–∏–º–∞–µ–º "–∫–≤–∞—Ä—Ç–∏—Ä—É" (namespace)

```bash
unshare --pid --net --mount --uts --ipc --user --fork bash
```

–®–∞–≥ 2: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º "–ø—Ä–∞–≤–∏–ª–∞ –¥–æ–º–∞" (cgroups)

```bash
mkdir /sys/fs/cgroup/myapp
echo "500M" > /sys/fs/cgroup/myapp/memory.max
echo "50000" > /sys/fs/cgroup/myapp/cpu.max
echo $$ > /sys/fs/cgroup/myapp/cgroup.procs
```

–®–∞–≥ 3: –î–∞–µ–º "–∫–ª—é—á–∏" (capabilities)

```bash
capsh --drop=all --add=cap_net_bind_service --add=cap_dac_read_search -- -c "./my-app"
```

–®–∞–≥ 4: –ù–∞–Ω–∏–º–∞–µ–º "–æ—Ö—Ä–∞–Ω–Ω–∏–∫–∞" (seccomp)

```bash
# –ó–∞–ø—É—Å–∫ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
docker run --security-opt seccomp=seccomp-profile.json my-app
```

–®–∞–≥ 5: –í–∫–ª—é—á–∞–µ–º "–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ" (eBPF + audit)

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
auditctl -a always,exit -S all -F pid=<CONTAINER_PID> -k container_audit
```

üåü –ò—Ç–æ–≥: –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ —Ö–æ—Ä–æ—à–æ

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

```bash
# –ï—Å–ª–∏ –≤–∑–ª–æ–º–∞—é—Ç –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:
# - –û–Ω –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –≤ —Å–≤–æ–µ–π "–∫–≤–∞—Ä—Ç–∏—Ä–µ" (namespace)
# - –ù–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (cgroups) 
# - –ò–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ (capabilities)
# - –ù–µ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –æ–ø–∞—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (seccomp)
# - –í—Å–µ –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è (audit)
```

–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```bash
# –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å—ã:
# - –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∑–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã (–Ω–µ –∫–∞–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã)
# - –ò—Å–ø–æ–ª—å–∑—É—é—Ç –º–∏–Ω–∏–º—É–º —Ä–µ—Å—É—Ä—Å–æ–≤ (–æ–±—â–µ–µ —è–¥—Ä–æ)
# - –ò–º–µ—é—Ç –Ω–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∂–µ–ª–µ–∑—É
```

–ì–∏–±–∫–æ—Å—Ç—å:

```bash
# –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–¥ –ª—é–±—ã–µ –Ω—É–∂–¥—ã:
# - –û—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ (production)
# - –î–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ (development)
# - –° —Ä–∞–∑–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```

üöÄ –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –¥–ª—è –≤–∞—Å

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

"–ü–∏—à–∏—Ç–µ –∫–æ–¥, –∞ —è–¥—Ä–æ Linux –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è –æ–± –∏–∑–æ–ª—è—Ü–∏–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!"

–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:

"–ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–æ—Ç–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤!"

–î–ª—è –±–∏–∑–Ω–µ—Å–∞:

"–≠–∫–æ–Ω–æ–º—å—Ç–µ –Ω–∞ –∂–µ–ª–µ–∑–µ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π!"

–í–æ—Ç –ø–æ—á–µ–º—É Docker –∏ Kubernetes —Å—Ç–∞–ª–∏ —Ç–∞–∫–∏–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ ‚Äî –æ–Ω–∏ —Å—Ç–æ—è—Ç –Ω–∞ –ø–ª–µ—á–∞—Ö –≥–∏–≥–∞–Ω—Ç–∞ (—è–¥—Ä–∞ Linux), –∫–æ—Ç–æ—Ä–æ–µ decades —Ä–∞–∑–≤–∏–≤–∞–ª–æ —ç—Ç–∏ –º–æ—â–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏–∑–æ–ª—è—Ü–∏–∏! üéØüê≥
}
        ]
      ]
}